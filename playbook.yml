---

# Any hosts

- hosts:
    - any
  become: true
  vars_files:
    - variables.yml
  tasks:
  - name: Place hosts files for internal domain resolving
    template:
      src: templates/etc/hosts
      dest: /etc/hosts

  - name: Install snapd packages
    apt:
      name: "{{ lxd_packages }}"
      state: latest
      update_cache: yes

  - name: Install LXD
    command: snap install lxd
    args:
      creates: /var/snap/lxd
    tags:
    - lxd

  - name: Place preseed file
    template:
      src: templates/tmp/preseed.yml
      dest: /tmp/preseed.yml
      owner: root
      group: root
      mode: 0644
    tags:
      preseed